<div class="login-wrapper">
    <div class="panel">
        <header class="brand">
            <img src="assets/logo.svg" alt="ERP" class="logo" />
            <h1>Restablece tu contraseña</h1>
            <p class="subtitle">Accede a tu panel de gestión</p>
        </header>

        <form *ngIf="!emailValid" [formGroup]="emailValidate" (ngSubmit)="validateEmail()"  novalidate>

            <div class="field">
                <label>Correo electrónico</label>
                <input #user type="email" class="input" formControlName="correo" autocomplete="email">
                <small *ngIf="emailValidate.controls['correo'].invalid && emailValidate.controls['correo'].touched">
                    Ingresa un email válido
                </small>
            </div>

            <button class="button primary full" [disabled]="loading || emailValidate.invalid" >
                <span *ngIf="!loading">Validar Correo</span>
                <span *ngIf="loading" class="spinner"></span>
            </button>

            <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>
        </form>

        <form *ngIf="emailValid" [formGroup]="passwordChange" (ngSubmit)="validatePassword()" novalidate>

            <div class="field">
                <label>Contraseña</label>
                <input type="password" formControlName="password" autocomplete="current-password"
                    [class.invalid]="passwordChange.controls['password'].invalid && passwordChange.controls['password'].touched" />
                <small
                    *ngIf="passwordChange.controls['password'].invalid && passwordChange.controls['password'].touched">
                    La contraseña es requerida
                </small>
            </div>
            <div class="field">
                <label>Confirmar Contraseña</label>
                <input type="password" formControlName="confirmPassword" autocomplete="current-password"
                    [class.invalid]="passwordChange.controls['confirmPassword'].invalid && passwordChange.controls['confirmPassword'].touched" />
                <small
                    *ngIf="passwordChange.controls['confirmPassword'].invalid && passwordChange.controls['confirmPassword'].touched">
                    La contraseña es requerida
                </small>
            </div>

            <button class="button primary full" [disabled]="loading || passwordChange.invalid">
                <span *ngIf="!loading">Cambiar Contraseña</span>
                <span *ngIf="loading" class="spinner"></span>
            </button>

            <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>
        </form>

        <footer class="panel-footer">
            <button type="button" class="button secondary sm" (click)="switchTheme()">
                Cambiar a {{ getThemeService().current === 'light' ? 'oscuro' : 'claro' }}
            </button>
        </footer>
    </div>
</div>